package nvd_api

import (
  "github.com/google/uuid"
  "pmdn.org/nvd-go/cve"
  "pmdn.org/nvd-go/cvss"
  "pmdn.org/nvd-go/rfc3339"
  "pmdn.org/nvd-go/nvd-api/cvss2"
  // "pmdn.org/nvd-go/nvd-api/cvss30"
  // "pmdn.org/nvd-go/nvd-api/cvss31"
)

type Vulnerability struct {
  Cve struct {
    Id cve.Id `json:"id"`
    SourceIdentifier *string `json:"sourceIdentifier"`
    Published rfc3339.DateTime `json:"published"`
    LastModified rfc3339.DateTime `json:"lastModified"`
    VulnStatus *string `json:"vulnStatus"`
    EvaluatorComment *string `json:"evaluatorComment"`
    EvaluatorSolution *string `json:"evaluatorSolution"`
    EvaluatorImpact *string `json:"evaluatorImpact"`
    CisaExploitAdd *rfc3339.Date `json:"cisaExploitAdd"`
    CisaActionDue *rfc3339.Date `json:"cisaActionDue"`
    CisaRequiredAction *rfc3339.Date `json:"cisaRequiredAction"`
    CisaVulnerabilityName *rfc3339.Date `json:"cisaVulnerabilityName"`
    Descriptions []LangString `json:"descriptions"`
    References []struct {
      Url RefUrl `json:"url"`
      Source string `json:"source"`
      Tags []string `json:"tags"`
    } `json:"references"`

    Metrics struct {
      CvssMetricsV2 []struct {
        Source string `json:"source"`
        Type MetricType `json:"type"`
        CvssData struct {
          // CVSS V2 version string (required).
          Version CvssV2Version `json:"version"`

          // CVSS V2 vector string (required).
          VectorString string `json:"vectorString"` // TODO: v2 vector

          // CVSS V2 base score (required).
          BaseScore cvss.Score `json:"baseScore"`

          AccessVector *cvss2.AccessVector `json:"accessVector"`
          AccessComplexity *cvss2.AccessComplexity `json:"accessComplexity"`
          Authentication *cvss2.Authentication `json:"authentication"`
          ConfidentialityImpact *cvss2.Cia `json:"confidentialityImpact"`
          IntegrityImpact *cvss2.Cia `json:"integrityImpact"`
          AvailabilityImpact *cvss2.Cia `json:"availabilityImpact"`
          Exploitability *cvss2.Exploitability `json:"exploitability"`
          RemediationLevel *cvss2.RemediationLevel `json:"remediationLevel"`
          ReportConfidence *cvss2.ReportConfidence `json:"reportConfidence"`
          TemporalScore *cvss.Score `json:"temporalScore"`
          CollateralDamagePotential *cvss.Score `json:"collateralDamagePotential"`
          TargetDistribution *cvss2.TargetDistribution `json:"targetDistribution"`
          ConfidentialityRequirement *cvss2.Cia `json:"confidentialityRequirement"`
          IntegrityRequirement *cvss2.Cia `json:"integrityRequirement"`
          AvailabilityRequirement *cvss2.Cia `json:"availabilityRequirement"`
          EnvironmentalScore *cvss.Score `json:"environmentalScore"`
          // TODO
        } `json:"cvssData"`
        BaseSeverity *cvss.Severity `json:"baseSeverity"`
        ExploitabilityScore *cvss.Score `json:"exploitabilityScore"`
        ImpactScore *cvss.Score `json:"impactScore"`
        AcInsufInfo *bool `json:"acInsufInfo"`
        ObtainAllPrivilege *bool `json:"obtainAllPrivilege"`
        ObtainUserPrivilege *bool `json:"obtainUserPrivilege"`
        ObtainOtherPrivilege *bool `json:"obtainOtherPrivilege"`
        UserInteractionRequired *bool `json:"userInteractionRequired"`
      } `json:"cvssMetricsV2"`

      CvssMetricsV30 []struct {
        Source string `json:"source"`
        Type MetricType `json:"type"`
        CvssData struct {
          // TODO
        } `json:"cvssData"`
        ExploitabilityScore *cvss.Score `json:"exploitabilityScore"`
        ImpactScore *cvss.Score `json:"impactScore"`
      } `json:"cvssMetricsV30"`

      CvssMetricsV31 []struct {
        Source string `json:"source"`
        Type MetricType `json:"type"`
        CvssData struct {
          // TODO
        } `json:"cvssData"`
        ExploitabilityScore *cvss.Score `json:"exploitabilityScore"`
        ImpactScore *cvss.Score `json:"impactScore"`
      } `json:"cvssMetricsV31"`
    } `json:"metrics"`

    Weaknesses []struct {
      Source string `json:"source"`
      Type string `json:"type"`
      Description []LangString `json:"description"`
    } `json:"weaknesses"`

    Configurations []struct {
      Operator Operator `json:"operator"` // enum: AND, OR
      Negate bool `json:"negate"`
      Nodes []struct {
        Operator Operator `json:"operator"` // enum: AND, OR
        Negate bool `json:"negate"`
        CpeMatch []struct {
          Vulnerable bool `json:"vulnerable"`
          Criteria string `json:"criteria"`
          MatchCriteriaId uuid.UUID `json:"matchCriteriaId"`
          VersionStartExcluding *string `json:"versionStartExcluding"`
          VersionStartIncluding *string `json:"versionStartIncluding"`
          VersionEndExcluding *string `json:"versionEndExcluding"`
          VersionEndIncluding *string `json:"versionEndIncluding"`
        } `json:"cpeMatch"`
      } `json:"nodes"`
    } `json:"configurations"`

    VendorComments []struct {
      Organization string `json:"organization"`
      Comment string `json:"comment"`
      LastModified rfc3339.DateTime `json:"lastModified"`
    } `json:"vendorComments"`
  } `json:"cve"`
}
