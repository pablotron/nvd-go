package nvd_api

import (
  "github.com/google/uuid"
  "pmdn.org/nvd-go/cve"
  "pmdn.org/nvd-go/cvss"
  "pmdn.org/nvd-go/rfc3339"
  "pmdn.org/nvd-go/nvd-api/cvss2"
  "pmdn.org/nvd-go/nvd-api/cvss30"
  "pmdn.org/nvd-go/nvd-api/cvss31"
)

type Vulnerability struct {
  Cve struct {
    Id cve.Id `json:"id"`
    SourceIdentifier *string `json:"sourceIdentifier"`
    Published rfc3339.DateTime `json:"published"`
    LastModified rfc3339.DateTime `json:"lastModified"`
    VulnStatus *string `json:"vulnStatus"`
    EvaluatorComment *string `json:"evaluatorComment"`
    EvaluatorSolution *string `json:"evaluatorSolution"`
    EvaluatorImpact *string `json:"evaluatorImpact"`
    CisaExploitAdd *rfc3339.Date `json:"cisaExploitAdd"`
    CisaActionDue *rfc3339.Date `json:"cisaActionDue"`
    CisaRequiredAction *rfc3339.Date `json:"cisaRequiredAction"`
    CisaVulnerabilityName *rfc3339.Date `json:"cisaVulnerabilityName"`
    Descriptions []LangString `json:"descriptions"`
    References []struct {
      Url RefUrl `json:"url"`
      Source string `json:"source"`
      Tags []string `json:"tags"`
    } `json:"references"`

    Metrics struct {
      CvssMetricsV2 []struct {
        Source string `json:"source"`
        Type MetricType `json:"type"`
        CvssData struct {
          // CVSS V2 version string (required).
          Version cvss2.Version `json:"version"`

          // CVSS V2 vector string (required).
          VectorString string `json:"vectorString"` // TODO: v2 vector

          // CVSS V2 base score (required).
          BaseScore cvss.Score `json:"baseScore"`

          AccessVector *cvss2.AccessVector `json:"accessVector"`
          AccessComplexity *cvss2.AccessComplexity `json:"accessComplexity"`
          Authentication *cvss2.Authentication `json:"authentication"`
          ConfidentialityImpact *cvss2.Cia `json:"confidentialityImpact"`
          IntegrityImpact *cvss2.Cia `json:"integrityImpact"`
          AvailabilityImpact *cvss2.Cia `json:"availabilityImpact"`
          Exploitability *cvss2.Exploitability `json:"exploitability"`
          RemediationLevel *cvss2.RemediationLevel `json:"remediationLevel"`
          ReportConfidence *cvss2.ReportConfidence `json:"reportConfidence"`
          TemporalScore *cvss.Score `json:"temporalScore"`
          CollateralDamagePotential *cvss.Score `json:"collateralDamagePotential"`
          TargetDistribution *cvss2.TargetDistribution `json:"targetDistribution"`
          ConfidentialityRequirement *cvss2.Cia `json:"confidentialityRequirement"`
          IntegrityRequirement *cvss2.Cia `json:"integrityRequirement"`
          AvailabilityRequirement *cvss2.Cia `json:"availabilityRequirement"`
          EnvironmentalScore *cvss.Score `json:"environmentalScore"`
          // TODO
        } `json:"cvssData"`
        BaseSeverity *cvss.Severity `json:"baseSeverity"`
        ExploitabilityScore *cvss.Score `json:"exploitabilityScore"`
        ImpactScore *cvss.Score `json:"impactScore"`
        AcInsufInfo *bool `json:"acInsufInfo"`
        ObtainAllPrivilege *bool `json:"obtainAllPrivilege"`
        ObtainUserPrivilege *bool `json:"obtainUserPrivilege"`
        ObtainOtherPrivilege *bool `json:"obtainOtherPrivilege"`
        UserInteractionRequired *bool `json:"userInteractionRequired"`
      } `json:"cvssMetricsV2"`

      CvssMetricsV30 []struct {
        Source string `json:"source"`
        Type MetricType `json:"type"`
        CvssData struct {
          // CVSS v3.0 version string (required).
          Version cvss30.Version `json:"version"`

          // CVSS v3.0 vector string (required).
          VectorString string `json:"vectorString"` // TODO: v30 vector

          // CVSS v3.0 base score (required).
          BaseScore cvss.Score `json:"baseScore"`

          // CVSS v3.0 base severity (required).
          BaseSeverity cvss.Severity `json:"baseSeverity"`

          AttackVector *cvss30.AttackVector `json:"attackVector"`
          AttackComplexity *cvss30.AttackComplexity `json:"attackComplexity"`
          PrivilegesRequired *cvss30.PrivilegesRequired `json:"privilegesRequired"`
          UserInteraction *cvss30.UserInteraction `json:"userInteraction"`
          Scope *cvss30.Scope `json:"scope"`
          ConfidentialityImpact *cvss30.Cia `json:"confidentialityImpact"`
          IntegrityImpact *cvss30.Cia `json:"integrityImpact"`
          AvailabilityImpact *cvss30.Cia `json:"availabilityImpact"`
          ExploitCodeMaturity *cvss30.ExploitCodeMaturity `json:"exploitCodeMaturity"`
          RemediationLevel *cvss30.RemediationLevel `json:"remediationLevel"`
          ReportConfidence *cvss30.Confidence `json:"reportConfidence"`
          TemporalScore *cvss.Score `json:"temporalScore"`
          TemporalSeverity *cvss.Severity `json:"temporalSeverity"`
          ConfidentialityRequirement *cvss30.Cia `json:"confidentialityRequirement"`
          IntegrityRequirement *cvss30.Cia `json:"integrityRequirement"`
          AvailabilityRequirement *cvss30.Cia `json:"availabilityRequirement"`
          ModifiedAttackVector *cvss30.ModifiedAttackVector `json:"modifiedAttackVector"`
          ModifiedAttackComplexity *cvss30.ModifiedAttackComplexity `json:"modifiedAttackComplexity"`
          ModifiedPrivilegesRequired *cvss30.ModifiedPrivilegesRequired `json:"modifiedPrivilegesRequired"`
          ModifiedUserInteraction *cvss30.ModifiedUserInteraction `json:"modifiedUserInteraction"`
          ModifiedScope *cvss30.ModifiedScope `json:"modifiedScope"`
          ModifiedConfidentialityImpact *cvss30.ModifiedCia `json:"modifiedConfidentialityImpact"`
          ModifiedIntegrityImpact *cvss30.ModifiedCia `json:"modifiedIntegrityImpact"`
          ModifiedAvailabilityImpact *cvss30.ModifiedCia `json:"modifiedAvailabilityImpact"`
          EnvironmentalScore *cvss.Score `json:"environmentalScore"`
          EnvironmentalSeverity *cvss.Severity `json:"environmentalSeverity"`
        } `json:"cvssData"`
        ExploitabilityScore *cvss.Score `json:"exploitabilityScore"`
        ImpactScore *cvss.Score `json:"impactScore"`
      } `json:"cvssMetricsV30"`

      CvssMetricsV31 []struct {
        Source string `json:"source"`
        Type MetricType `json:"type"`
        CvssData struct {
          // CVSS v3.1 version string (required).
          Version cvss31.Version `json:"version"`

          // CVSS v3.1 vector string (required).
          VectorString string `json:"vectorString"` // TODO: v31 vector

          // CVSS v3.1 base score (required).
          BaseScore cvss.Score `json:"baseScore"`

          // CVSS v3.1 base severity (required).
          BaseSeverity cvss.Severity `json:"baseSeverity"`

          AttackVector *cvss31.AttackVector `json:"attackVector"`
          AttackComplexity *cvss31.AttackComplexity `json:"attackComplexity"`
          PrivilegesRequired *cvss31.PrivilegesRequired `json:"privilegesRequired"`
          UserInteraction *cvss31.UserInteraction `json:"userInteraction"`
          Scope *cvss31.Scope `json:"scope"`
          ConfidentialityImpact *cvss31.Cia `json:"confidentialityImpact"`
          IntegrityImpact *cvss31.Cia `json:"integrityImpact"`
          AvailabilityImpact *cvss31.Cia `json:"availabilityImpact"`
          ExploitCodeMaturity *cvss31.ExploitCodeMaturity `json:"exploitCodeMaturity"`
          RemediationLevel *cvss31.RemediationLevel `json:"remediationLevel"`
          ReportConfidence *cvss31.Confidence `json:"reportConfidence"`
          TemporalScore *cvss.Score `json:"temporalScore"`
          TemporalSeverity *cvss.Severity `json:"temporalSeverity"`
          ConfidentialityRequirement *cvss31.Cia `json:"confidentialityRequirement"`
          IntegrityRequirement *cvss31.Cia `json:"integrityRequirement"`
          AvailabilityRequirement *cvss31.Cia `json:"availabilityRequirement"`
          ModifiedAttackVector *cvss31.ModifiedAttackVector `json:"modifiedAttackVector"`
          ModifiedAttackComplexity *cvss31.ModifiedAttackComplexity `json:"modifiedAttackComplexity"`
          ModifiedPrivilegesRequired *cvss31.ModifiedPrivilegesRequired `json:"modifiedPrivilegesRequired"`
          ModifiedUserInteraction *cvss31.ModifiedUserInteraction `json:"modifiedUserInteraction"`
          ModifiedScope *cvss31.ModifiedScope `json:"modifiedScope"`
          ModifiedConfidentialityImpact *cvss31.ModifiedCia `json:"modifiedConfidentialityImpact"`
          ModifiedIntegrityImpact *cvss31.ModifiedCia `json:"modifiedIntegrityImpact"`
          ModifiedAvailabilityImpact *cvss31.ModifiedCia `json:"modifiedAvailabilityImpact"`
          EnvironmentalScore *cvss.Score `json:"environmentalScore"`
          EnvironmentalSeverity *cvss.Severity `json:"environmentalSeverity"`
        } `json:"cvssData"`
        ExploitabilityScore *cvss.Score `json:"exploitabilityScore"`
        ImpactScore *cvss.Score `json:"impactScore"`
      } `json:"cvssMetricsV31"`
    } `json:"metrics"`

    Weaknesses []struct {
      Source string `json:"source"`
      Type string `json:"type"`
      Description []LangString `json:"description"`
    } `json:"weaknesses"`

    Configurations []struct {
      Operator Operator `json:"operator"` // enum: AND, OR
      Negate bool `json:"negate"`
      Nodes []struct {
        Operator Operator `json:"operator"` // enum: AND, OR
        Negate bool `json:"negate"`
        CpeMatch []struct {
          Vulnerable bool `json:"vulnerable"`
          Criteria string `json:"criteria"`
          MatchCriteriaId uuid.UUID `json:"matchCriteriaId"`
          VersionStartExcluding *string `json:"versionStartExcluding"`
          VersionStartIncluding *string `json:"versionStartIncluding"`
          VersionEndExcluding *string `json:"versionEndExcluding"`
          VersionEndIncluding *string `json:"versionEndIncluding"`
        } `json:"cpeMatch"`
      } `json:"nodes"`
    } `json:"configurations"`

    VendorComments []struct {
      Organization string `json:"organization"`
      Comment string `json:"comment"`
      LastModified rfc3339.DateTime `json:"lastModified"`
    } `json:"vendorComments"`
  } `json:"cve"`
}
