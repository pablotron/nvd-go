package nvd_api

import (
  "github.com/google/uuid"
  "pmdn.org/nvd-go/cpe"
  "pmdn.org/nvd-go/cve"
  "pmdn.org/nvd-go/cvss"
  "pmdn.org/nvd-go/cvss/v2"
  "pmdn.org/nvd-go/cvss/v30"
  "pmdn.org/nvd-go/cvss/v31"
  "pmdn.org/nvd-go/rfc3339"
)

type Vulnerability struct {
  Cve struct {
    Id cve.Id `json:"id"`
    SourceIdentifier *string `json:"sourceIdentifier"`
    Published rfc3339.DateTime `json:"published"`
    LastModified rfc3339.DateTime `json:"lastModified"`
    VulnStatus *string `json:"vulnStatus"`
    EvaluatorComment *string `json:"evaluatorComment"`
    EvaluatorSolution *string `json:"evaluatorSolution"`
    EvaluatorImpact *string `json:"evaluatorImpact"`
    CisaExploitAdd *rfc3339.Date `json:"cisaExploitAdd"`
    CisaActionDue *rfc3339.Date `json:"cisaActionDue"`
    CisaRequiredAction *rfc3339.Date `json:"cisaRequiredAction"`
    CisaVulnerabilityName *rfc3339.Date `json:"cisaVulnerabilityName"`
    Descriptions []LangString `json:"descriptions"`
    References []struct {
      Url RefUrl `json:"url"`
      Source string `json:"source"`
      Tags []string `json:"tags"`
    } `json:"references"`

    Metrics struct {
      CvssMetricsV2 []struct {
        Source string `json:"source"`
        Type MetricType `json:"type"`
        CvssData struct {
          // CVSS V2 version string (required).
          Version v2.VersionString `json:"version"`

          // CVSS V2 vector string (required).
          Vector v2.Vector `json:"vectorString"`

          // CVSS V2 base score (required).
          BaseScore cvss.Score `json:"baseScore"`

          AccessVector *v2.AccessVector `json:"accessVector"`
          AccessComplexity *v2.AccessComplexity `json:"accessComplexity"`
          Authentication *v2.Authentication `json:"authentication"`
          ConfidentialityImpact *v2.Cia `json:"confidentialityImpact"`
          IntegrityImpact *v2.Cia `json:"integrityImpact"`
          AvailabilityImpact *v2.Cia `json:"availabilityImpact"`
          Exploitability *v2.Exploitability `json:"exploitability"`
          RemediationLevel *v2.RemediationLevel `json:"remediationLevel"`
          ReportConfidence *v2.ReportConfidence `json:"reportConfidence"`
          TemporalScore *cvss.Score `json:"temporalScore"`
          CollateralDamagePotential *cvss.Score `json:"collateralDamagePotential"`
          TargetDistribution *v2.TargetDistribution `json:"targetDistribution"`
          ConfidentialityRequirement *v2.Cia `json:"confidentialityRequirement"`
          IntegrityRequirement *v2.Cia `json:"integrityRequirement"`
          AvailabilityRequirement *v2.Cia `json:"availabilityRequirement"`
          EnvironmentalScore *cvss.Score `json:"environmentalScore"`
          // TODO
        } `json:"cvssData"`
        BaseSeverity *cvss.Severity `json:"baseSeverity"`
        ExploitabilityScore *cvss.Score `json:"exploitabilityScore"`
        ImpactScore *cvss.Score `json:"impactScore"`
        AcInsufInfo *bool `json:"acInsufInfo"`
        ObtainAllPrivilege *bool `json:"obtainAllPrivilege"`
        ObtainUserPrivilege *bool `json:"obtainUserPrivilege"`
        ObtainOtherPrivilege *bool `json:"obtainOtherPrivilege"`
        UserInteractionRequired *bool `json:"userInteractionRequired"`
      } `json:"cvssMetricV2"`

      CvssMetricV30 []struct {
        Source string `json:"source"`
        Type MetricType `json:"type"`
        CvssData struct {
          // CVSS v3.0 version string (required).
          Version v30.VersionString `json:"version"`

          // CVSS v3.0 vector string (required).
          Vector v30.Vector `json:"vectorString"`

          // CVSS v3.0 base score (required).
          BaseScore cvss.Score `json:"baseScore"`

          // CVSS v3.0 base severity (required).
          BaseSeverity cvss.Severity `json:"baseSeverity"`

          AttackVector *v30.AttackVector `json:"attackVector"`
          AttackComplexity *v30.AttackComplexity `json:"attackComplexity"`
          PrivilegesRequired *v30.PrivilegesRequired `json:"privilegesRequired"`
          UserInteraction *v30.UserInteraction `json:"userInteraction"`
          Scope *v30.Scope `json:"scope"`
          ConfidentialityImpact *v30.Cia `json:"confidentialityImpact"`
          IntegrityImpact *v30.Cia `json:"integrityImpact"`
          AvailabilityImpact *v30.Cia `json:"availabilityImpact"`
          ExploitCodeMaturity *v30.ExploitCodeMaturity `json:"exploitCodeMaturity"`
          RemediationLevel *v30.RemediationLevel `json:"remediationLevel"`
          ReportConfidence *v30.Confidence `json:"reportConfidence"`
          TemporalScore *cvss.Score `json:"temporalScore"`
          TemporalSeverity *cvss.Severity `json:"temporalSeverity"`
          ConfidentialityRequirement *v30.Cia `json:"confidentialityRequirement"`
          IntegrityRequirement *v30.Cia `json:"integrityRequirement"`
          AvailabilityRequirement *v30.Cia `json:"availabilityRequirement"`
          ModifiedAttackVector *v30.ModifiedAttackVector `json:"modifiedAttackVector"`
          ModifiedAttackComplexity *v30.ModifiedAttackComplexity `json:"modifiedAttackComplexity"`
          ModifiedPrivilegesRequired *v30.ModifiedPrivilegesRequired `json:"modifiedPrivilegesRequired"`
          ModifiedUserInteraction *v30.ModifiedUserInteraction `json:"modifiedUserInteraction"`
          ModifiedScope *v30.ModifiedScope `json:"modifiedScope"`
          ModifiedConfidentialityImpact *v30.ModifiedCia `json:"modifiedConfidentialityImpact"`
          ModifiedIntegrityImpact *v30.ModifiedCia `json:"modifiedIntegrityImpact"`
          ModifiedAvailabilityImpact *v30.ModifiedCia `json:"modifiedAvailabilityImpact"`
          EnvironmentalScore *cvss.Score `json:"environmentalScore"`
          EnvironmentalSeverity *cvss.Severity `json:"environmentalSeverity"`
        } `json:"cvssData"`
        ExploitabilityScore *cvss.Score `json:"exploitabilityScore"`
        ImpactScore *cvss.Score `json:"impactScore"`
      } `json:"cvssMetricV30"`

      CvssMetricV31 []struct {
        Source string `json:"source"`
        Type MetricType `json:"type"`
        CvssData struct {
          // CVSS v3.1 version string (required).
          Version v31.VersionString `json:"version"`

          // CVSS v3.1 vector string (required).
          Vector v31.Vector `json:"vectorString"`

          // CVSS v3.1 base score (required).
          BaseScore cvss.Score `json:"baseScore"`

          // CVSS v3.1 base severity (required).
          BaseSeverity cvss.Severity `json:"baseSeverity"`

          AttackVector *v31.AttackVector `json:"attackVector"`
          AttackComplexity *v31.AttackComplexity `json:"attackComplexity"`
          PrivilegesRequired *v31.PrivilegesRequired `json:"privilegesRequired"`
          UserInteraction *v31.UserInteraction `json:"userInteraction"`
          Scope *v31.Scope `json:"scope"`
          ConfidentialityImpact *v31.Cia `json:"confidentialityImpact"`
          IntegrityImpact *v31.Cia `json:"integrityImpact"`
          AvailabilityImpact *v31.Cia `json:"availabilityImpact"`
          ExploitCodeMaturity *v31.ExploitCodeMaturity `json:"exploitCodeMaturity"`
          RemediationLevel *v31.RemediationLevel `json:"remediationLevel"`
          ReportConfidence *v31.Confidence `json:"reportConfidence"`
          TemporalScore *cvss.Score `json:"temporalScore"`
          TemporalSeverity *cvss.Severity `json:"temporalSeverity"`
          ConfidentialityRequirement *v31.Cia `json:"confidentialityRequirement"`
          IntegrityRequirement *v31.Cia `json:"integrityRequirement"`
          AvailabilityRequirement *v31.Cia `json:"availabilityRequirement"`
          ModifiedAttackVector *v31.ModifiedAttackVector `json:"modifiedAttackVector"`
          ModifiedAttackComplexity *v31.ModifiedAttackComplexity `json:"modifiedAttackComplexity"`
          ModifiedPrivilegesRequired *v31.ModifiedPrivilegesRequired `json:"modifiedPrivilegesRequired"`
          ModifiedUserInteraction *v31.ModifiedUserInteraction `json:"modifiedUserInteraction"`
          ModifiedScope *v31.ModifiedScope `json:"modifiedScope"`
          ModifiedConfidentialityImpact *v31.ModifiedCia `json:"modifiedConfidentialityImpact"`
          ModifiedIntegrityImpact *v31.ModifiedCia `json:"modifiedIntegrityImpact"`
          ModifiedAvailabilityImpact *v31.ModifiedCia `json:"modifiedAvailabilityImpact"`
          EnvironmentalScore *cvss.Score `json:"environmentalScore"`
          EnvironmentalSeverity *cvss.Severity `json:"environmentalSeverity"`
        } `json:"cvssData"`
        ExploitabilityScore *cvss.Score `json:"exploitabilityScore"`
        ImpactScore *cvss.Score `json:"impactScore"`
      } `json:"cvssMetricV31"`
    } `json:"metrics"`

    Weaknesses []struct {
      Source string `json:"source"`
      Type string `json:"type"`
      Description []LangString `json:"description"`
    } `json:"weaknesses"`

    Configurations []struct {
      Operator Operator `json:"operator"`
      Negate bool `json:"negate"`
      Nodes []struct {
        Operator Operator `json:"operator"`
        Negate bool `json:"negate"`
        CpeMatch []struct {
          Vulnerable bool `json:"vulnerable"`
          Criteria cpe.Match `json:"criteria"`
          MatchCriteriaId uuid.UUID `json:"matchCriteriaId"`
          VersionStartExcluding *string `json:"versionStartExcluding"`
          VersionStartIncluding *string `json:"versionStartIncluding"`
          VersionEndExcluding *string `json:"versionEndExcluding"`
          VersionEndIncluding *string `json:"versionEndIncluding"`
        } `json:"cpeMatch"`
      } `json:"nodes"`
    } `json:"configurations"`

    VendorComments []struct {
      Organization string `json:"organization"`
      Comment string `json:"comment"`
      LastModified rfc3339.DateTime `json:"lastModified"`
    } `json:"vendorComments"`
  } `json:"cve"`
}
